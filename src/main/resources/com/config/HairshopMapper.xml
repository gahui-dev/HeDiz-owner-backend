<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.config.HairshopMapper">

    <!--특정 미용실 조회-->
    <select id="hairshopFind" resultType="HairshopDTO" parameterType="int">
        select shop_seq, shop_name, shop_register, shop_id, shop_pw, shop_address, shop_intro, shop_image, shop_start, shop_end, shop_phone, shop_regular, shop_tag
        from T_HAIRSHOP
        where shop_seq=#{shop_seq}
    </select>

    <!--미용실 데이터 수정-->
    <update id="hairshopUpdate" parameterType="HairshopDTO">
        update T_HAIRSHOP set
        shop_regular=#{shop_regular},
        shop_address=#{shop_address},
        shop_phone=#{shop_phone},
        shop_start=#{shop_start},
        shop_end=#{shop_end},
        shop_image=#{shop_image},
        shop_intro=#{shop_intro},
        shop_tag=#{shop_tag}
        where shop_seq=#{shop_seq}
    </update>

    <!--회원가입-->
    <insert id="signUp" parameterType="HairshopDTO">
        INSERT INTO T_HAIRSHOP (shop_name, shop_register, shop_id, shop_pw, shop_address, shop_intro, shop_image, shop_start, shop_end, shop_phone, shop_regular, shop_tag)
        VALUES (#{shop_name}, #{shop_register}, #{shop_id}, #{shop_pw}, #{shop_address}, #{shop_intro}, #{shop_image}, #{shop_start}, #{shop_end}, #{shop_phone}, #{shop_regular}, #{shop_tag})
    </insert>

    <!-- 휴무일 조회 -->
    <select id="tempdayFind" resultType="TempdayDTO">
<!--        SELECT temp_seq, te.shop_seq, st.staff_name as title, temp_offday as date-->
<!--        FROM T_TEMPDAY te-->
<!--        LEFT JOIN T_STAFF st ON te.staff_seq = st.staff_seq-->
<!--        where te.shop_seq=#{shop_seq}-->
        SELECT a.temp_seq, b.staff_seq, b.staff_nickname, a.temp_start, a.temp_end, a.temp_memo, c.shop_regular
          FROM T_TEMPDAY AS a
          LEFT JOIN T_STAFF AS b
            ON a.staff_seq = b.staff_seq
         INNER JOIN T_HAIRSHOP AS c
            ON a.shop_seq = c.shop_seq
         WHERE a.shop_seq = #{shop_seq};
    </select>

    <!--임시휴무일 추가-->
    <insert id="tempdayAdd" parameterType="TempdayDTO">
<!--        INSERT INTO T_TEMPDAY (shop_seq, staff_seq, temp_offday)-->
<!--        VALUES (#{shop_seq},-->
<!--        (SELECT staff_seq FROM T_STAFF WHERE staff_name = #{staff_name}),-->
<!--        #{temp_offday})-->
        INSERT INTO T_TEMPDAY (shop_seq, staff_seq, temp_start, temp_end, temp_memo)
        VALUES (#{shop_seq}, #{staff_seq}, #{temp_start}, #{temp_end}, #{temp_memo})
    </insert>
</mapper>